{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref } from 'vue';\nimport L from 'leaflet';\nimport \"leaflet/dist/leaflet.css\";\nimport axios from 'axios';\nimport marker_img from '~/assets/marker.png';\nexport default {\n  __name: 'explorerMap',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const mapContainer = ref(null);\n    let map;\n    let markers = [];\n    onMounted(() => {\n      map = L.map(mapContainer.value).setView([0, 0], 2);\n      //map = L.map(mapContainer.value).fitWorld();\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors'\n      }).addTo(map);\n\n      //   const bounds = [[-90, -180], [90, 180]]\n      //   map.fitBounds(bounds);\n\n      fetchCoordinates();\n      map.on('click', event => {\n        handleMapClick(event.latlng);\n      });\n    });\n    async function fetchCoordinates() {\n      var myIcon = L.icon({\n        iconUrl: marker_img,\n        iconSize: [38, 95],\n        iconAnchor: [22, 94],\n        popupAnchor: [-3, -76]\n        //shadowUrl: ,\n        //shadowSize: [68, 95],\n        //shadowAnchor: [22, 94]\n      });\n      try {\n        const response = await axios.get('http://0.0.0.0:8000/collection_map/');\n        let data = response.data; // Assuming the API response is an array of marker data\n        console.log(data);\n        data = JSON.parse(data);\n        // console.log(typeof(data2))\n        // console.log(data2.length)\n        // console.log(data2[0])\n        data.forEach(item => {\n          console.log(item);\n          console.log(item.Latitude);\n          console.log(parseFloat(item.Latitude));\n          const marker = L.marker([parseFloat(item.Latitude), parseFloat(item.Longitude)], {\n            icon: myIcon\n          }).addTo(map);\n          markers.push(marker);\n          // You can customize marker properties and add popup information here\n        });\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    }\n    function handleMapClick(latLng) {\n      console.log('Clicked coordinates:', latLng.lat, latLng.lng);\n      addMarker({\n        lat: latLng.lat,\n        lng: latLng.lng\n      });\n    }\n    function addMarker(position) {\n      const marker = L.marker(position).addTo(map);\n      markers.push(marker);\n      marker.on('click', () => {\n        handleMarkerClick(marker);\n      });\n    }\n    function handleMarkerClick(marker) {\n      console.log('Clicked marker:', marker);\n      // Add your logic for handling marker click events here\n    }\n    const __returned__ = {\n      mapContainer,\n      get map() {\n        return map;\n      },\n      set map(v) {\n        map = v;\n      },\n      get markers() {\n        return markers;\n      },\n      set markers(v) {\n        markers = v;\n      },\n      fetchCoordinates,\n      handleMapClick,\n      addMarker,\n      handleMarkerClick,\n      onMounted,\n      ref,\n      get L() {\n        return L;\n      },\n      get axios() {\n        return axios;\n      },\n      get marker_img() {\n        return marker_img;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","L","axios","marker_img","mapContainer","map","markers","value","setView","tileLayer","attribution","addTo","fetchCoordinates","on","event","handleMapClick","latlng","myIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","response","get","data","console","log","JSON","parse","forEach","item","Latitude","parseFloat","marker","Longitude","push","error","latLng","lat","lng","addMarker","position","handleMarkerClick"],"sources":["/home/zhu/Documents/github/explorer_front/explorer_front_app/src/components/explorerMap.vue"],"sourcesContent":["<template>\n  <div ref=\"mapContainer\" style=\"width: 60%; height: 800px;\"></div>\n</template>\n\n<script setup>\nimport { onMounted, ref } from 'vue';\nimport L from 'leaflet';\nimport \"leaflet/dist/leaflet.css\";\nimport axios from 'axios';\nimport marker_img from '~/assets/marker.png'\n\nconst mapContainer = ref(null);\nlet map;\nlet markers = [];\n\nonMounted(() => {\n   map = L.map(mapContainer.value).setView([0,0],2);\n    //map = L.map(mapContainer.value).fitWorld();\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n    attribution: '&copy; OpenStreetMap contributors',\n  }).addTo(map);\n\n//   const bounds = [[-90, -180], [90, 180]]\n//   map.fitBounds(bounds);\n\n    fetchCoordinates();\n\n  map.on('click', (event) => {\n    handleMapClick(event.latlng);\n  });\n});\n\nasync function fetchCoordinates(){\n    var myIcon = L.icon({\n    iconUrl: marker_img,\n    iconSize: [38, 95],\n    iconAnchor: [22, 94],\n    popupAnchor: [-3, -76],\n    //shadowUrl: ,\n    //shadowSize: [68, 95],\n    //shadowAnchor: [22, 94]\n});\n\n    try {\n        const response = await axios.get('http://0.0.0.0:8000/collection_map/');\n        let data = response.data; // Assuming the API response is an array of marker data\n        console.log(data)\n        data = JSON.parse(data)\n        // console.log(typeof(data2))\n        // console.log(data2.length)\n        // console.log(data2[0])\n        data.forEach(item => {\n            console.log(item)\n            console.log(item.Latitude)\n            console.log(parseFloat(item.Latitude))\n            const marker = L.marker([parseFloat(item.Latitude), parseFloat(item.Longitude)], {icon: myIcon}).addTo(map);\n            markers.push(marker);\n        // You can customize marker properties and add popup information here\n    });\n  } catch (error) {\n        console.error('Error fetching data:', error);\n  }    \n}\n\nfunction handleMapClick(latLng) {\n  console.log('Clicked coordinates:', latLng.lat, latLng.lng);\n  addMarker({ lat: latLng.lat, lng: latLng.lng });\n}\n\nfunction addMarker(position) {\n  const marker = L.marker(position).addTo(map);\n  markers.push(marker);\n\n  marker.on('click', () => {\n    handleMarkerClick(marker);\n  });\n}\n\nfunction handleMarkerClick(marker) {\n  console.log('Clicked marker:', marker);\n  // Add your logic for handling marker click events here\n}\n</script>\n\n<style>\n\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}