{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-6991b281\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  ref: \"mapContainer\",\n  class: \"map-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"iframe-popup\"\n};\nconst _hoisted_3 = [\"src\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, null, 512 /* NEED_PATCH */), $setup.showPopup ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createCommentVNode(\" <iframe :src=\\\"'https://www.morphosource.org/uv.html#?manifest=/manifests/44b0cd03-9165-4367-b20a-8ed303a2f3c4'\\\" width=\\\"560\\\" height =\\\"420\\\" frameborder=\\\"0\\\" allow=\\\"fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\\\"></iframe> \"), _createElementVNode(\"iframe\", {\n    src: $setup.popupURL,\n    width: \"800\",\n    height: \"420\",\n    frameborder: \"0\",\n    allow: \"fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n  }, null, 8 /* PROPS */, _hoisted_3)])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["ref","class","key","_createElementBlock","_createElementVNode","_hoisted_1","$setup","showPopup","_hoisted_2","_createCommentVNode","src","popupURL","width","height","frameborder","allow","_hoisted_3"],"sources":["/home/zhu/Documents/github/explorer_front/explorer_front_app/src/components/GalapagosMap.vue"],"sourcesContent":["<template>\n<div>\n  <div ref=\"mapContainer\" class=\"map-container\"></div>\n  \n  <div v-if=\"showPopup\" class=\"iframe-popup\">\n    <!-- <iframe :src=\"'https://www.morphosource.org/uv.html#?manifest=/manifests/44b0cd03-9165-4367-b20a-8ed303a2f3c4'\" width=\"560\" height =\"420\" frameborder=\"0\" allow=\"fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"></iframe> -->\n    <iframe :src=popupURL width=\"800\" height =\"420\" frameborder=\"0\" allow=\"fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"></iframe>\n  </div>\n</div>\n</template>\n\n\n\n<script setup>\nimport {ref, onMounted} from 'vue';\nimport L from 'leaflet';\n\nimport markerImage from '@/assets/marker.png'\n\nimport 'leaflet-draw/dist/leaflet.draw.css';\nimport 'leaflet-draw/dist/leaflet.draw';\nimport islandsJSON from '../assets/galapagos.json';\n\nconst mapContainer = ref(null);\nconst showPopup = ref(false);\nlet map;\nlet markers = [];\n\nlet islandMarkers = {'Isabela Island': [[-0.0358333333, -91.3761111111]],\n  'EspaÃ±ola Island': [[-1.3541666667,  -89.6598611111]]\n}\n\nconst iframeURLs = {\n  turtle: 'https://www.morphosource.org/uv.html#?manifest=/manifests/44b0cd03-9165-4367-b20a-8ed303a2f3c4',\n  iguana: 'https://www.morphosource.org/uv.html#?manifest=/manifests/d22b0459-dbfe-4d32-b35e-fac4e0ee33e6',\n  'Amblyrhynchus cristatus': 'https://www.morphosource.org/uv.html#?manifest=/manifests/9bfc88a8-8f39-4993-ad89-591ca0b7948f'\n};\n\nonMounted(() => {\n      map = L.map(mapContainer.value).setView([-0.207259, -90.142578], 8); \n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\n      \n\n      addIslands();\n      // addMarkers();\n      // setupMarkerClickEvents();\n\n      var drawnItems = new L.FeatureGroup();\n      map.addLayer(drawnItems);\n\n      var drawControl = new L.Control.Draw({\n        draw: {\n          polygon: true,\n          polyline: false,\n          rectangle: false,\n          circle: false,\n          marker: false,\n        },\n        edit: {\n          featureGroup: drawnItems,\n          edit: false,\n          remove: false,\n        },\n      });\n\n      map.addControl(drawControl);\n\n      map.on(L.Draw.Event.CREATED, function (event) {\n      var layer = event.layer;\n      drawnItems.addLayer(layer);\n\n      // Do something with the drawn polygon, like getting its coordinates\n      var polygonCoordinates = layer.getLatLngs();\n      console.log(\"layer info\", layer);\n      var geoJSONinfo = layer.toGeoJSON();\n      console.log(\"geoJSON: \", geoJSONinfo);\n      console.log(JSON.stringify(geoJSONinfo.geometry.coordinates));\n      console.log(polygonCoordinates);\n      console.log(JSON.stringify(polygonCoordinates));\n\n      layer.bindPopup('<p>Island <br>'+JSON.stringify(geoJSONinfo)+'</p>');\n  \n      });\n\n\n    //return { mapContainer };\n  });\n  \n\n  function addMarkers(whichIsland){\n\n       var myIcon = L.icon({\n        //iconUrl: require('./src/assets/marker.png'),\n        iconUrl: markerImage,\n        //iconSize: [38, 95],\n        //iconAnchor: [22, 94],\n        //popupAnchor: [-3, -76],\n        //shadowUrl: ,\n        //shadowSize: [68, 95],\n        //shadowAnchor: [22, 94]\n      });\n\n      // markers = [\n      //   L.marker([-0.0358333333, -91.3761111111], {icon: myIcon}).bindPopup('turtle').addTo(map),\n      //   L.marker([-1.3541666667,  -89.6598611111], {icon: myIcon}).bindPopup('iguana').addTo(map),\n      //   L.marker([\t0.3630555556, -90.5347222222], {icon: myIcon}).bindPopup('Amblyrhynchus cristatus').addTo(map)\n      // ];\n\n      console.log(islandMarkers[whichIsland])\n\n      for (const coord in islandMarkers[whichIsland]) \n        console.log(coord)\n        markers = [\n          L.marker(coord, {icon: myIcon}).bindPopup('turtle').addTo(map)\n        ];\n\n      setupMarkerClickEvents();\n   }\n\n  function setupMarkerClickEvents(){\n      markers.forEach(marker => {\n        marker.on('click', () =>{\n          openPopup(marker);\n        });\n      });\n   }\n\n  function openPopup(marker){\n      const popupURLKey = marker.getPopup().getContent();\n      //console.log(popupURLKey);\n      popupURL.value = iframeURLs[popupURLKey]\n      //console.log(popupURL)\n      showPopup.value = true;\n   }\n\nfunction addIslands(){\n    const geojsonLayer = L.geoJSON(islandsJSON, {\n        style: {\n          color: 'blue',\n          weight: 1,\n          fillOpacity: 0.1,\n        },\n      }).addTo(map);\n\n      geojsonLayer.on('click', (event) =>{\n        const feature = event.layer.feature;\n        console.log(feature.properties.name);\n        var whichIsland = feature.properties.name;\n        // popupURL.value = iframeURLs['turtle'];\n        // popupURL.value = true;\n\n\n        //set-up addMarkers and setupMarkerClickEvents in here?\n        // pass island name (feature.properties.name)\n\n        addMarkers(whichIsland);\n        //setupMarkerClickEvents();\n\n      });\n  }\n\nconst popupURL = ref('');\n\n</script>\n\n<style scoped>\n.map-container {\n  height: 850px; /* Set map container height */\n  width: 80%;\n}\n\n.iframe-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 600px; /* Adjust as needed */\n  height: 100%;\n  background-color: white;\n  z-index: 1000;\n}\n\niframe {\n  width: 100%;\n  height: 100%;\n}\n</style>"],"mappings":";;;EAEOA,GAAG,EAAC,cAAc;EAACC,KAAK,EAAC;;;EAFhCC,GAAA;EAIwBD,KAAK,EAAC;;mBAJ9B;;uBACAE,mBAAA,CAOM,cANJC,mBAAA,CAAoD,OAApDC,UAAoD,+BAEzCC,MAAA,CAAAC,SAAS,I,cAApBJ,mBAAA,CAGM,OAHNK,UAGM,GAFJC,mBAAA,+QAAwQ,EACxQL,mBAAA,CAAqK;IAA5JM,GAAG,EAACJ,MAAA,CAAAK,QAAQ;IAACC,KAAK,EAAC,KAAK;IAACC,MAAM,EAAE,KAAK;IAACC,WAAW,EAAC,GAAG;IAACC,KAAK,EAAC;0BAN1EC,UAAA,E,KAAAP,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}